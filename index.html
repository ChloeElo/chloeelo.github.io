<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<head>
<style>

body {
	position:absolute;
	background-color: #36393e;
	margin: 0;
	overflow:auto;
	-ms-overflow-style: none;  /* Internet Explorer 10+ */
    scrollbar-width: none;  /* Firefox */
    text-align: center;
	touch-action: pan-y;
}

body::-webkit-scrollbar { 
    display: none;  /* Safari and Chrome */
}

#contentbox {
	position: absolute;
	width: 100vw;
}

.grouptitle {
	color: white;
	font-family: 'Comic Sans MS', 'Chalkboard SE', 'Comic Neue', sans-serif;
}

.grid-container {
	display: grid;
	grid-gap: 5px;
	width: 100vw;
	background-color: #36393e;
	justify-content: center;
    align-items: center;
    overflow: hidden;
	padding-top: 5px;
}

.image {
	max-width: 100%;
	max-height: 100%;
	object-fit: cover;
	aspect-ratio: 1;
	border-radius: 10px;
}

.nodrag {
	user-drag: none;
    -webkit-user-drag: none;
    user-select: none;
    -moz-user-select: none;
    -webkit-user-select: none;
    -ms-user-select: none;
}

.image:hover {
	outline: #9CFF00 solid 4px;
	transition:100ms;
}

#wideboy {
	position:absolute;
}

</style>
<link rel="icon" type="image/x-icon" href="favicon.ico" />
<!-- <script src="./index.js" defer></script> -->
<title>Search</title>

<script>
let width = window.innerWidth;
var blocks = Math.floor((width-100)/100); // Set default block width based on screen res
if (blocks < 1) { blocks = 1; }
if (blocks > 10) { blocks = 10; }

stylesheet = document.styleSheets[0]
stylesheet.insertRule(".grid-container { grid-template-columns: repeat("+String(blocks)+", minmax(0, 1fr));}", 0);

console.log(blocks);

</script>

</head>

<body>
	<div id='wideboy'> &nbsp </div> <!-- Makes page wider so it can scroll -->
	<!--<h1 id='reporter' style='position:absolute;top:0px;'> Hello </h1>-->
	<!--<h1 id='reporter2' style='position:absolute;top:30px;'> Hello2 </h1>-->
	<div id="contentbox">
		
	</div>

</body>

<script>
	
	grid_xscale = [0,0.15,0.3,0.45,0.6,0.75,0.85,0.95,1.1]; // 1.1 is there for initial block scaling reference
	
	
	var dragStartBlocks = 2;
	var dragState = 0;
	var dragStartX;
	document.addEventListener("pointerdown", (event) => {
		dragState = 1;
		dragStartX = event.clientX;
		dragStartBlocks = blocks;
	});
	
	document.addEventListener("pointermove", (event) => {
		if (dragState != 0) {
			let currentX = event.clientX;
			let newblocks = dragStartBlocks - Math.floor( (currentX-dragStartX+50)/100 )
			if (newblocks>10) { newblocks = 10 };
			if (newblocks<1) { newblocks = 1 };
			//console.log(newblocks);
			if (newblocks != blocks ) {
				blocks = newblocks;
				reblockGrid();
			}
		}
	});
	
	document.addEventListener("pointerup", (event) => {
		dragState = 0; // End dragging event
	});
	
	var current_blocks = 2;
	document.addEventListener("scroll", (event) => {
		//document.getElementById("reporter").innerHTML = window.pageXOffset;
		//document.getElementById("reporter2").innerHTML = window.innerWidth;
		console.log(blocks);
		if (blocks != current_blocks) {
			current_blocks = blocks;
			setTimeout(reblockGrid(),1);
		}
	})
	
	function reblockGrid() {
		document.querySelectorAll('.grid-container').forEach((group) => {
			group.style["grid-template-columns"] = 'repeat('+String(blocks)+', minmax(0, 1fr))';
		});
	}
	
	function mkElement(type, id, clas) {
		let newel = document.createElement(type);
		if (id) {
			newel.setAttribute("id", id);
		}
		if (clas) {
			newel.setAttribute("class", clas);
		}
		return newel;
	}
	
	for (let i=10; i > 0; i--) {
		let newheader = mkElement("h1", "header"+String(i), "grouptitle nodrag");
		newheader.innerHTML = 'Season '+String(i)
		document.getElementById("contentbox").appendChild(newheader);
		
		let newgroup =  mkElement("div", "group"+String(i), "grid-container nodrag");
		document.getElementById("contentbox").appendChild(newgroup);
	}
	
	for (let i=996; i > 0; i--) {
		let newimg = mkElement("img", "img"+String(i), "image nodrag");
		newimg.src = 'Images/'+String(i)+'.webp'
		newimg.loading = 'lazy'
		document.getElementById("group"+String(Math.floor((i-1)/100)+1)).appendChild(newimg);
	}
	
</script>

</html>
